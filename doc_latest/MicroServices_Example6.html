---
layout: default
title: Example 6 - Spell Checker Service Module
---
  <head>
    <title>C++ Micro Services: Example 6 - Spell Checker Service Module</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
  </head>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="MicroServices_Tutorials.html">Tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example 6 - Spell Checker Service <a class="el" href="classModule.html" title="Represents a CppMicroServices module. ">Module</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this example, we complicate things further by defining a new service that uses an arbitrary number of dictionary services to perform its function. More precisely, we define a spell checker service which will aggregate all dictionary services and provide another service that allows us to spell check passages using our underlying dictionary services to verify the spelling of words. Our module will only provide the spell checker service if there are at least two dictionary services available. First, we will start by defining the spell checker service interface in a file called <code>spellcheckservice/ISpellCheckService.h</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;usServiceInterface.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef Example_spellcheckservice_EXPORTS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">  #define SPELLCHECKSERVICE_EXPORT US_ABI_EXPORT</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">  #define SPELLCHECKSERVICE_EXPORT US_ABI_IMPORT</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment"></span></div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * A simple service interface that defines a spell check service. A spell check</span></div>
<div class="line"><span class="comment"> * service checks the spelling of all words in a given passage. A passage is any</span></div>
<div class="line"><span class="comment"> * number of words separated by a space character and the following punctuation</span></div>
<div class="line"><span class="comment"> * marks: comma, period, exclamation mark, question mark, semi-colon, and colon.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>SPELLCHECKSERVICE_EXPORT ISpellCheckService</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Out-of-line virtual desctructor for proper dynamic cast</span></div>
<div class="line">  <span class="comment">// support with older versions of gcc.</span></div>
<div class="line">  <span class="keyword">virtual</span> ~ISpellCheckService();</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * Checks a given passage for spelling errors. A passage is any number of</span></div>
<div class="line"><span class="comment">   * words separated by a space and any of the following punctuation marks:</span></div>
<div class="line"><span class="comment">   * comma (,), period (.), exclamation mark (!), question mark (?),</span></div>
<div class="line"><span class="comment">   * semi-colon (;), and colon(:).</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param passage the passage to spell check.</span></div>
<div class="line"><span class="comment">   * @return A list of misspelled words.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> std::vector&lt;std::string&gt; Check(<span class="keyword">const</span> std::string&amp; passage) = 0;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__MicroServices.html#gad5c1340dcd99d403c8da0c52b8db30bb">US_DECLARE_SERVICE_INTERFACE</a>(ISpellCheckService, <span class="stringliteral">&quot;ISpellCheckService/1.0&quot;</span>)</div>
</div><!-- fragment --><p> The service interface is quite simple, with only one method that needs to be implemented. Because we provide an empty out-of-line destructor (defined in the file <code>ISpellCheckService.cpp</code>) we must export the service interface by using the module specific <code>SPELLCHECKSERVICE_EXPORT</code> macro.</p>
<p>In the following source code, the module needs to create a complete list of all dictionary services; this is somewhat tricky and must be done carefully if done manually via service event listners. Our module makes use of the <code><a class="el" href="classServiceTracker.html" title="The ServiceTracker class simplifies using services from the framework&#39;s service registry. ">ServiceTracker</a></code> and <code><a class="el" href="structServiceTrackerCustomizer.html" title="The ServiceTrackerCustomizer interface allows a ServiceTracker to customize the service objects that ...">ServiceTrackerCustomizer</a></code> classes to robustly react to service events related to dictionary services. The module activator of our module now additionally implements the <code><a class="el" href="structServiceTrackerCustomizer.html" title="The ServiceTrackerCustomizer interface allows a ServiceTracker to customize the service objects that ...">ServiceTrackerCustomizer</a></code> class to be automatically notified of arriving, departing, or modified dictionary services. In case of a newly added dictionary service, our <code><a class="el" href="structServiceTrackerCustomizer.html#a669ad55b3016b33559b1785aa80c2ec6" title="A service is being added to the ServiceTracker. ">ServiceTrackerCustomizer::AddingService()</a></code> implementation checks if a spell checker service was already registered and if not registers a new <code>ISpellCheckService</code> instance if at lead two dictionary services are available. If the number of dictionary services drops below two, our <code><a class="el" href="structServiceTrackerCustomizer.html" title="The ServiceTrackerCustomizer interface allows a ServiceTracker to customize the service objects that ...">ServiceTrackerCustomizer</a></code> implementation un-registers the previously registered spell checker service instance. These actions must be performed in a synchronized manner to avoid interference from service events originating from different threads. The implementation of our module activator is done in a file called <code>spellcheckservice/Activator.cpp</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;IDictionaryService.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ISpellCheckService.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;usModuleActivator.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;usModuleContext.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;usServiceProperties.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;usServiceTracker.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;usServiceTrackerCustomizer.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"></div>
<div class="line">US_USE_NAMESPACE</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * This class implements a module that implements a spell</span></div>
<div class="line"><span class="comment"> * checker service. The spell checker service uses all available</span></div>
<div class="line"><span class="comment"> * dictionary services to check for the existence of words in</span></div>
<div class="line"><span class="comment"> * a given sentence. This module uses a ServiceTracker to</span></div>
<div class="line"><span class="comment"> * monitors the dynamic availability of dictionary services,</span></div>
<div class="line"><span class="comment"> * and to aggregate all available dictionary services as they</span></div>
<div class="line"><span class="comment"> * arrive and depart. The spell checker service is only registered</span></div>
<div class="line"><span class="comment"> * if there are dictionary services available, thus the spell</span></div>
<div class="line"><span class="comment"> * checker service will appear and disappear as dictionary</span></div>
<div class="line"><span class="comment"> * services appear and disappear, respectively.</span></div>
<div class="line"><span class="comment">**/</span></div>
<div class="line"><span class="keyword">class </span>US_ABI_LOCAL Activator : <span class="keyword">public</span> <a class="code" href="structModuleActivator.html">ModuleActivator</a>, <span class="keyword">public</span> <a class="code" href="structServiceTrackerCustomizer.html">ServiceTrackerCustomizer</a>&lt;IDictionaryService&gt;</div>
<div class="line">{</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * A private inner class that implements a spell check service; see</span></div>
<div class="line"><span class="comment">   * ISpellCheckService for details of the service.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">class </span>SpellCheckImpl : <span class="keyword">public</span> ISpellCheckService</div>
<div class="line">  {</div>
<div class="line"></div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line"></div>
<div class="line">    <span class="keyword">typedef</span> std::map&lt;ServiceReference&lt;IDictionaryService&gt;, IDictionaryService*&gt; RefToServiceType;</div>
<div class="line">    RefToServiceType m_refToSvcMap;</div>
<div class="line"></div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * Implements ISpellCheckService::Check(). Checks the given passage for</span></div>
<div class="line"><span class="comment">     * misspelled words.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * @param passage the passage to spell check.</span></div>
<div class="line"><span class="comment">     * @return A list of misspelled words.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    std::vector&lt;std::string&gt; Check(<span class="keyword">const</span> std::string&amp; passage)</div>
<div class="line">    {</div>
<div class="line">      std::vector&lt;std::string&gt; errorList;</div>
<div class="line"></div>
<div class="line">      <span class="comment">// No misspelled words for an empty string.</span></div>
<div class="line">      <span class="keywordflow">if</span> (passage.empty())</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">return</span> errorList;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">// Tokenize the passage using spaces and punctuation.</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">char</span>* delimiters = <span class="stringliteral">&quot; ,.!?;:&quot;</span>;</div>
<div class="line">      <span class="keywordtype">char</span>* passageCopy = <span class="keyword">new</span> <span class="keywordtype">char</span>[passage.size()+1];</div>
<div class="line">      std::memcpy(passageCopy, passage.c_str(), passage.size()+1);</div>
<div class="line">      <span class="keywordtype">char</span>* pch = std::strtok(passageCopy, delimiters);</div>
<div class="line"></div>
<div class="line">      {</div>
<div class="line">        <span class="comment">// Lock the m_refToSvcMap member using your favorite thread library here...</span></div>
<div class="line">        <span class="comment">// MutexLocker lock(&amp;m_refToSvcMapMutex)</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">// Loop through each word in the passage.</span></div>
<div class="line">        <span class="keywordflow">while</span> (pch)</div>
<div class="line">        {</div>
<div class="line">          std::string word(pch);</div>
<div class="line"></div>
<div class="line">          <span class="keywordtype">bool</span> correct = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">          <span class="comment">// Check each available dictionary for the current word.</span></div>
<div class="line">          <span class="keywordflow">for</span> (RefToServiceType::const_iterator i = m_refToSvcMap.begin();</div>
<div class="line">               (!correct) &amp;&amp; (i != m_refToSvcMap.end()); ++i)</div>
<div class="line">          {</div>
<div class="line">            IDictionaryService* dictionary = i-&gt;second;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (dictionary-&gt;CheckWord(word))</div>
<div class="line">            {</div>
<div class="line">              correct = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"></div>
<div class="line">          <span class="comment">// If the word is not correct, then add it</span></div>
<div class="line">          <span class="comment">// to the incorrect word list.</span></div>
<div class="line">          <span class="keywordflow">if</span> (!correct)</div>
<div class="line">          {</div>
<div class="line">            errorList.push_back(word);</div>
<div class="line">          }</div>
<div class="line"></div>
<div class="line">          pch = std::strtok(NULL, delimiters);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="keyword">delete</span>[] passageCopy;</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">return</span> errorList;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    std::size_t AddDictionary(<span class="keyword">const</span> <a class="code" href="classServiceReference.html">ServiceReference&lt;IDictionaryService&gt;</a>&amp; ref, IDictionaryService* dictionary)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// Lock the m_refToSvcMap member using your favorite thread library here...</span></div>
<div class="line">      <span class="comment">// MutexLocker lock(&amp;m_refToSvcMapMutex)</span></div>
<div class="line"></div>
<div class="line">      m_refToSvcMap.insert(std::make_pair(ref, dictionary));</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">return</span> m_refToSvcMap.size();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    std::size_t RemoveDictionary(<span class="keyword">const</span> <a class="code" href="classServiceReference.html">ServiceReference&lt;IDictionaryService&gt;</a>&amp; ref)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// Lock the m_refToSvcMap member using your favorite thread library here...</span></div>
<div class="line">      <span class="comment">// MutexLocker lock(&amp;m_refToSvcMapMutex)</span></div>
<div class="line"></div>
<div class="line">      m_refToSvcMap.erase(ref);</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">return</span> m_refToSvcMap.size();</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line">  <span class="keyword">virtual</span> IDictionaryService* <a class="code" href="structServiceTrackerCustomizer.html#a669ad55b3016b33559b1785aa80c2ec6">AddingService</a>(<span class="keyword">const</span> <a class="code" href="classServiceReference.html">ServiceReference&lt;IDictionaryService&gt;</a>&amp; reference)</div>
<div class="line">  {</div>
<div class="line">    IDictionaryService* dictionary = m_context-&gt;<a class="code" href="classServiceTracker.html#a7414dba0db0db4e12b0acbc67d1ee65d">GetService</a>(reference);</div>
<div class="line">    std::size_t count = m_spellCheckService-&gt;AddDictionary(reference, dictionary);</div>
<div class="line">    <span class="keywordflow">if</span> (!m_spellCheckReg &amp;&amp; count &gt; 1)</div>
<div class="line">    {</div>
<div class="line">      m_spellCheckReg = m_context-&gt;RegisterService&lt;ISpellCheckService&gt;(m_spellCheckService.get());</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> dictionary;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structServiceTrackerCustomizer.html#ac380c3d0fdab1ed95b52a5d4660cbe19">ModifiedService</a>(<span class="keyword">const</span> <a class="code" href="classServiceReference.html">ServiceReference&lt;IDictionaryService&gt;</a>&amp; <span class="comment">/*reference*/</span>,</div>
<div class="line">                               IDictionaryService* <span class="comment">/*service*/</span>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// do nothing</span></div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structServiceTrackerCustomizer.html#a15ad851d60fceb25b979a874f620179f">RemovedService</a>(<span class="keyword">const</span> <a class="code" href="classServiceReference.html">ServiceReference&lt;IDictionaryService&gt;</a>&amp; reference,</div>
<div class="line">                              IDictionaryService* <span class="comment">/*service*/</span>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> (m_spellCheckService-&gt;RemoveDictionary(reference) &lt; 2 &amp;&amp; m_spellCheckReg)</div>
<div class="line">    {</div>
<div class="line">      m_spellCheckReg.Unregister();</div>
<div class="line">      m_spellCheckReg = 0;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  std::auto_ptr&lt;SpellCheckImpl&gt; m_spellCheckService;</div>
<div class="line">  <a class="code" href="classServiceRegistration.html">ServiceRegistration&lt;ISpellCheckService&gt;</a> m_spellCheckReg;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="classModuleContext.html">ModuleContext</a>* m_context;</div>
<div class="line">  std::auto_ptr&lt;ServiceTracker&lt;IDictionaryService&gt; &gt; m_tracker;</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">  Activator()</div>
<div class="line">    : m_context(NULL)</div>
<div class="line">  {}</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * Implements ModuleActivator::Load(). Registers an</span></div>
<div class="line"><span class="comment">   * instance of a dictionary service using the module context;</span></div>
<div class="line"><span class="comment">   * attaches properties to the service that can be queried</span></div>
<div class="line"><span class="comment">   * when performing a service look-up.</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param context the context for the module.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="structModuleActivator.html#a1db3f85c15a814a5918eb22725229967">Load</a>(<a class="code" href="classModuleContext.html">ModuleContext</a>* context)</div>
<div class="line">  {</div>
<div class="line">    m_context = context;</div>
<div class="line"></div>
<div class="line">    m_spellCheckService.reset(<span class="keyword">new</span> SpellCheckImpl);</div>
<div class="line">    m_tracker.reset(<span class="keyword">new</span> <a class="code" href="classServiceTracker.html">ServiceTracker&lt;IDictionaryService&gt;</a>(context, <span class="keyword">this</span>));</div>
<div class="line">    m_tracker-&gt;Open();</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * Implements ModuleActivator::Unload(). Does nothing since</span></div>
<div class="line"><span class="comment">   * the C++ Micro Services library will automatically unregister any registered services</span></div>
<div class="line"><span class="comment">   * and release any used services.</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param context the context for the module.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="structModuleActivator.html#a410a3f54b7cad990e8d670450677218c">Unload</a>(<a class="code" href="classModuleContext.html">ModuleContext</a>* <span class="comment">/*context*/</span>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// NOTE: The service is automatically unregistered</span></div>
<div class="line"></div>
<div class="line">    m_tracker-&gt;Close();</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__MicroServices.html#gac441a2e64f59a76a5f7e42de67e87cba">US_EXPORT_MODULE_ACTIVATOR</a>(spellcheckservice, Activator)</div>
</div><!-- fragment --><p> Note that we do not need to unregister the service in stop() method, because the C++ Micro Services library will automatically do so for us. The spell checker service that we have implemented is very simple; it simply parses a given passage into words and then loops through all available dictionary services for each word until it determines that the word is correct. <a class="el" href="classAny.html" title="An Any class represents a general type and is capable of storing any type, supporting type-safe extra...">Any</a> incorrect words are added to an error list that will be returned to the caller. This solution is not optimal and is only intended for educational purposes.</p>
<dl class="section note"><dt>Note</dt><dd>In this example, the service interface and implementation are both contained in one module which exports the interface class. However, service implementations almost never need to be exported and in many use cases it is beneficial to provide the service interface and its implementation(s) in separate modules. In such a scenario, clients of a service will only have a link-time dependency on the shared library providing the service interface (because of the out-of-line destructor) but not on any modules containing service implementations. This often leads to modules which do not export any symbols at all and hence need to be loaded into the running process manually or by using the <a class="el" href="MicroServices_AutoLoading.html">auto-loading mechanism</a>.</dd>
<dd>
Due to the link dependency of our module to the module containing the dictionary service interface as well as a default implementation for it, there might be at least one dictionary service registered when our module is loaded, depending on your linker settings (e.g. on Windows, the linker usually by default optimizes the link dependency away since our module does not actually use any symbols from the dictionaryservice module. On Linux however, the link dependency is kept by default.) To observe the dynamic registration and un-registration of our spell checker service, we require the availability of at least two dictionary services.</dd></dl>
<p>For an introduction how to compile our source code, see <a class="el" href="MicroServices_Example1.html">Example 1 - Service Event Listener</a>.</p>
<p>After running the <code>CppMicroServicesExampleDriver</code> program we should make sure that the module from Example 1 is active. We can use the <code>s</code> shell command to get a list of all modules, their state, and their module identifier number. If the Example 1 module is not active, we should load the module using the load command and the module's identifier number or name that is displayed by the <code>s</code> command. Now we can load the spell checker service module by entering the <code>l spellcheckservice</code> command which will also trigger the loading of the dictionaryservice module containing the english dictionary:</p>
<pre class="fragment">CppMicroServices-build&gt; bin/CppMicroServicesExampleDriver
&gt; l eventlistener
Starting to listen for service events.
&gt; l spellcheckservice
Ex1: Service of type IDictionaryService/1.0 registered.
&gt; s
Id | Name                 | Status
-----------------------------------
 - | dictionaryclient     | -
 - | dictionaryclient2    | -
 - | dictionaryclient3    | -
 - | frenchdictionary     | -
 - | spellcheckclient     | -
 1 | CppMicroServices     | LOADED
 2 | Event Listener       | LOADED
 3 | Dictionary Service   | LOADED
 4 | Spell Check Service  | LOADED
&gt;
</pre><p>To trigger the registration of the spell checker service from our module, we load the frenchdictionary using the <code>l frenchdictionary</code> command. If the module from <a class="el" href="MicroServices_Example1.html">Example 1</a> is still active, then we should see it print out the details of the service event it receives when our new module registers its spell checker service:</p>
<pre class="fragment">CppMicroServices-build&gt; bin/CppMicroServicesExampleDriver
&gt; l frenchdictionary
Ex1: Service of type IDictionaryService/1.0 registered.
Ex1: Service of type ISpellCheckService/1.0 registered.
&gt;
</pre><p>We can experiment with our spell checker service's dynamic availability by stopping the french dictionary service; when the service is stopped, the eventlistener module will print that our module is no longer offering its spell checker service. Likewise, when the french dictionary service comes back, so will our spell checker service. We create a client for our spell checker service in <a class="el" href="MicroServices_Example7.html">Example 7</a>. To exit the <code>CppMicroServicesExampleDriver</code> program, we use the <code>q</code> command.</p>
<p>Next: <a class="el" href="MicroServices_Example7.html">Example 7 - Spell Checker Client Module</a></p>
<p>Previous: <a class="el" href="MicroServices_Example5.html">Example 5 - Service Tracker Dictionary Client Module</a> </p>
</div></div><!-- contents -->

  <hr class="footer"/>
  <address class="footer"><small>Generated on Mon Dec 16 2013 for C++ Micro Services 1.99.0 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.8.5
</small></address>
