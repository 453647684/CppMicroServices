---
layout: default
title: Example 7 - Spell Checker Client Module
---
  <head>
    <title>C++ Micro Services: Example 7 - Spell Checker Client Module</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
  </head>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="MicroServices_Tutorials.html">Tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example 7 - Spell Checker Client <a class="el" href="classModule.html" title="Represents a CppMicroServices module. ">Module</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this example we create a client for the spell checker service we implemented in <a class="el" href="MicroServices_Example6.html">Example 6</a>. This client monitors the dynamic availability of the spell checker service using the Service Tracker and is very similar in structure to the dictionary client we implemented in <a class="el" href="MicroServices_Example5.html">Example 5</a>. The functionality of the spell checker client reads passages from standard input and spell checks them using the spell checker service. Our module uses its module context to create a <code><a class="el" href="classServiceTracker.html" title="The ServiceTracker class simplifies using services from the framework&#39;s service registry. ">ServiceTracker</a></code> object to monitor spell checker services. The source code for our module is as follows in a file called <code>spellcheckclient/Activator.cpp</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;ISpellCheckService.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;usModuleActivator.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;usModuleContext.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;usServiceTracker.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"></div>
<div class="line">US_USE_NAMESPACE</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * This class implements a module that uses a spell checker</span></div>
<div class="line"><span class="comment"> * service to check the spelling of a passage. This module</span></div>
<div class="line"><span class="comment"> * is essentially identical to Example 5, in that it uses the</span></div>
<div class="line"><span class="comment"> * Service Tracker to monitor the dynamic availability of the</span></div>
<div class="line"><span class="comment"> * spell checker service. When loading this module, the thread</span></div>
<div class="line"><span class="comment"> * calling the Load() method is used to read passages from</span></div>
<div class="line"><span class="comment"> * standard input. You can stop spell checking passages by</span></div>
<div class="line"><span class="comment"> * entering an empty line, but to start spell checking again</span></div>
<div class="line"><span class="comment"> * you must un-load and then load the module again.</span></div>
<div class="line"><span class="comment">**/</span></div>
<div class="line"><span class="keyword">class </span>US_ABI_LOCAL Activator : <span class="keyword">public</span> <a class="code" href="structModuleActivator.html">ModuleActivator</a></div>
<div class="line">{</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">  Activator()</div>
<div class="line">   : m_context(NULL)</div>
<div class="line">   , m_tracker(NULL)</div>
<div class="line">  {}</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * Implements ModuleActivator::Load(). Creates a service</span></div>
<div class="line"><span class="comment">   * tracker object to monitor spell checker services. Enters</span></div>
<div class="line"><span class="comment">   * a spell check loop where it reads passages from standard</span></div>
<div class="line"><span class="comment">   * input and checks their spelling using the spell checker service.</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * \note It is very bad practice to use the calling thread to perform a</span></div>
<div class="line"><span class="comment">   *       lengthy process like this; this is only done for the purpose of</span></div>
<div class="line"><span class="comment">   *       the tutorial.</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param context the module context for this module.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="structModuleActivator.html#a1db3f85c15a814a5918eb22725229967">Load</a>(<a class="code" href="classModuleContext.html">ModuleContext</a> *context)</div>
<div class="line">  {</div>
<div class="line">    m_context = context;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a service tracker to monitor spell check services.</span></div>
<div class="line">    m_tracker = <span class="keyword">new</span> <a class="code" href="classServiceTracker.html">ServiceTracker&lt;ISpellCheckService&gt;</a>(m_context);</div>
<div class="line">    m_tracker-&gt;<a class="code" href="classServiceTracker.html#af8ac56906cfe09d1451f82a634ea5bf3">Open</a>();</div>
<div class="line"></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Enter a blank line to exit.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Loop endlessly until the user enters a blank line</span></div>
<div class="line">    <span class="keywordflow">while</span> (std::cin)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// Ask the user to enter a passage.</span></div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Enter passage: &quot;</span>;</div>
<div class="line"></div>
<div class="line">      std::string passage;</div>
<div class="line">      std::getline(std::cin, passage);</div>
<div class="line"></div>
<div class="line">      <span class="comment">// Get the selected spell check service, if available.</span></div>
<div class="line">      ISpellCheckService* checker = m_tracker-&gt;GetService();</div>
<div class="line"></div>
<div class="line">      <span class="comment">// If the user entered a blank line, then</span></div>
<div class="line">      <span class="comment">// exit the loop.</span></div>
<div class="line">      <span class="keywordflow">if</span> (passage.empty())</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="comment">// If there is no spell checker, then say so.</span></div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (checker == NULL)</div>
<div class="line">      {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;No spell checker available.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      }</div>
<div class="line">      <span class="comment">// Otherwise check passage and print misspelled words.</span></div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">        std::vector&lt;std::string&gt; errors = checker-&gt;Check(passage);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (errors.empty())</div>
<div class="line">        {</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;Passage is correct.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;Incorrect word(s):&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">          <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; errors.size(); ++i)</div>
<div class="line">          {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; errors[i] &lt;&lt; std::endl;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// This automatically closes the tracker</span></div>
<div class="line">    <span class="keyword">delete</span> m_tracker;</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * Implements ModuleActivator::Unload(). Does nothing since</span></div>
<div class="line"><span class="comment">   * the C++ Micro Services library will automatically unget any used services.</span></div>
<div class="line"><span class="comment">   * @param context the context for the module.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="structModuleActivator.html#a410a3f54b7cad990e8d670450677218c">Unload</a>(<a class="code" href="classModuleContext.html">ModuleContext</a>* <span class="comment">/*context*/</span>)</div>
<div class="line">  {</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Module context</span></div>
<div class="line">  <a class="code" href="classModuleContext.html">ModuleContext</a>* m_context;</div>
<div class="line"></div>
<div class="line">  <span class="comment">// The service tracker</span></div>
<div class="line">  <a class="code" href="classServiceTracker.html">ServiceTracker&lt;ISpellCheckService&gt;</a>* m_tracker;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__MicroServices.html#gac441a2e64f59a76a5f7e42de67e87cba">US_EXPORT_MODULE_ACTIVATOR</a>(spellcheckclient, Activator)</div>
</div><!-- fragment --><p> After running the <code>CppMicroServicesExampleDriver</code> program use the <code>s</code> command to make sure that only the modules from Example 2, Example 2b, and Example 6 are loaded; use the load (<code>l</code>) and un-load (<code>u</code>) commands as appropriate to load and un-load the various tutorial modules, respectively. Now we can load our spell checker client module by entering <code>l spellcheckclient</code>:</p>
<pre class="fragment">CppMicroServices-build&gt; bin/CppMicroServicesExampleDriver
&gt; l
Starting to listen for service events.
&gt; l spellcheckservice
Ex1: Service of type IDictionaryService/1.0 registered.
&gt; s
Id | Name                 | Status
-----------------------------------
 - | dictionaryclient     | -
 - | dictionaryclient2    | -
 - | dictionaryclient3    | -
 - | frenchdictionary     | -
 - | spellcheckclient     | -
 1 | CppMicroServices     | LOADED
 2 | Event Listener       | LOADED
 3 | Dictionary Service   | LOADED
 4 | Spell Check Service  | LOADED
&gt;
</pre><p>To trigger the registration of the spell checker service from our module, we load the frenchdictionary using the <code>l frenchdictionary</code> command. If the module from <a class="el" href="MicroServices_Example1.html">Example 1</a> is still active, then we should see it print out the details of the service event it receives when our new module registers its spell checker service:</p>
<pre class="fragment">CppMicroServices-build&gt; bin/CppMicroServicesExampleDriver
&gt; l spellcheckservice
&gt; l frenchdictionary
&gt; l spellcheckclient
Enter a blank line to exit.
Enter passage:
</pre><p>When we start the module, it will use the main thread to prompt us for passages; a passage is a collection or words separate by spaces, commas, periods, exclamation points, question marks, colons, or semi-colons. Enter a passage and press the enter key to spell check the passage or enter a blank line to stop spell checking passages. To restart the module, we must use the command <code>s</code> command to get the module identifier number for the module and first use the <code>u</code> command to un-load the module, then the <code>l</code> command to re-load it.</p>
<p>Since this client uses the Service Tracker to monitor the dynamic availability of the spell checker service, it is robust in the scenario where the spell checker service suddenly departs. Further, when a spell checker service arrives, it automatically gets the service if it needs it and continues to function. These capabilities are a little difficult to demonstrate since we are using a simple single-threaded approach, but in a multi-threaded or GUI-oriented application this robustness is very useful.</p>
<p>Previous: <a class="el" href="MicroServices_Example6.html">Example 6 - Spell Checker Service Module</a> </p>
</div></div><!-- contents -->

  <hr class="footer"/>
  <address class="footer"><small>Generated on Sat Jan 11 2014 for C++ Micro Services 2.99.0 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.8.5
</small></address>
